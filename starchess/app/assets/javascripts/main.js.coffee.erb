#= depend_on_asset "starchess_game.html"
@strollz = angular.module('strollz', ['ngRoute','restangular','ui.bootstrap','firebase'])

@strollz.config(['RestangularProvider', (RestangularProvider) ->
  RestangularProvider.setBaseUrl('/1')
  # add a response intereceptor
  RestangularProvider.addResponseInterceptor( (data, operation, what, url, response, deferred) ->
    if operation == "getList"
      extractedData = data.response
      extractedData.count = data.count
      extractedData.pagination = data.pagination
    else 
      extractedData = data.response
    return extractedData
  )
  RestangularProvider.addRequestInterceptor( (element, operation, what, url) ->
    if operation == "put" and what == "starchess_games"
      element = {'starchess_game':element}
    return element
  )                                          
])
@strollz.config(['$routeProvider', ($routeProvider) ->
  $routeProvider.when('/StarchessGames/', {
      templateUrl: '../templates/starchess_games.html',
      controller: 'StarchessGamesCtrl'
    })
  $routeProvider.when('/StarchessGames/:gameId', {
      templateUrl: '<%= asset_path("starchess_game.html") %>',
      controller: 'StarchessGameCtrl',
      resolve: {
        game: ($route, Restangular) ->
          return Restangular.one('starchess_games',$route.current.params.gameId).get()
      }
    })
  $routeProvider.otherwise({
      templateUrl: '../templates/starchess_games.html',
      controller: 'StarchessGamesCtrl'
    }) 
])